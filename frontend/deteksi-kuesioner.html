<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Deteksi Depresi - Kuesioner - SADAR</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap");

      body {
        font-family: "Inter", sans-serif;
      }
    </style>
  </head>
  <body class="bg-gray-50">
    <div class="flex min-h-screen">
      <!-- Sidebar -->
      <aside class="w-64 bg-white border-r border-gray-200 fixed h-full">
        <div class="p-6">
          <!-- Logo -->
          <div class="flex items-center space-x-2 mb-10">
            <img src="img/log.png" alt="SADAR Logo" class="h-8" />
          </div>

          <!-- Navigation Menu -->
          <nav class="space-y-2">
            <!-- Dashboard -->
            <a
              href="dashboard.html"
              class="flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-600 hover:bg-gray-50 font-medium"
            >
              <svg
                class="w-5 h-5"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"
                />
              </svg>
              <span>Dashboard</span>
            </a>

            <!-- Deteksi Depresi - Active -->
            <a
              href="deteksi-depresi.html"
              class="flex items-center space-x-3 px-4 py-3 rounded-lg bg-blue-50 text-blue-600 font-medium"
            >
              <svg
                class="w-5 h-5"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"
                />
              </svg>
              <span>Deteksi Depresi</span>
            </a>

            <!-- Riwayat Deteksi -->
            <a
              href="riwayat-deteksi.html"
              class="flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-600 hover:bg-gray-50 font-medium"
            >
              <svg
                class="w-5 h-5"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
                />
              </svg>
              <span>Riwayat Deteksi</span>
            </a>

            <!-- Pengaturan -->
            <a
              href="pengaturan.html"
              class="flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-600 hover:bg-gray-50 font-medium"
            >
              <svg
                class="w-5 h-5"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"
                />
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"
                />
              </svg>
              <span>Pengaturan</span>
            </a>
          </nav>
        </div>
      </aside>

      <!-- Main Content -->
      <main class="flex-1 ml-64">
        <!-- Top Bar -->
        <header class="bg-white border-b border-gray-200 sticky top-0 z-10">
          <div class="px-8 py-4 flex items-center justify-between">
            <h1 class="text-3xl font-bold text-gray-800">Deteksi Depresi</h1>

            <div class="flex items-center space-x-4">
              <!-- Search Bar -->
              <div class="relative">
                <input
                  type="text"
                  placeholder="Search"
                  class="w-64 pl-10 pr-4 py-2 bg-gray-100 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"
                />
                <svg
                  class="w-5 h-5 text-gray-400 absolute left-3 top-2.5"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                  />
                </svg>
              </div>

              <!-- User Profile -->
              <div class="flex items-center space-x-3">
                <span class="text-sm font-medium text-gray-700"
                  >Ferdy Permana</span
                >
                <img
                  src="https://ui-avatars.com/api/?name=Ferdy Permana&background=ec4899&color=fff"
                  alt="User Avatar"
                  class="w-10 h-10 rounded-full"
                />
              </div>
            </div>
          </div>
        </header>

        <!-- Dashboard Content -->
        <div class="p-8">
          <div class="max-w-5xl mx-auto">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
              <!-- Left Column - Question -->
              <div class="lg:col-span-2">
                <div
                  class="bg-white rounded-2xl shadow-sm p-8 border border-gray-200"
                >
                  <h2 class="text-2xl font-bold text-gray-800 mb-2">
                    <span id="qTitle">Pertanyaan 1</span>
                  </h2>
                  <p class="text-gray-600 mb-8">
                    <span id="qText"></span>
                  </p>

                  <!-- Radio Options -->
                  <div class="space-y-4" id="options">
                    <label class="flex items-center space-x-3 cursor-pointer">
                      <input type="radio" name="answer" value="0" class="w-5 h-5 text-blue-600 focus:ring-blue-500" />
                      <span class="text-gray-700 font-medium">Tidak Pernah</span>
                    </label>
                    <label class="flex items-center space-x-3 cursor-pointer">
                      <input type="radio" name="answer" value="1" class="w-5 h-5 text-blue-600 focus:ring-blue-500" />
                      <span class="text-gray-700 font-medium">Beberapa Hari</span>
                    </label>
                    <label class="flex items-center space-x-3 cursor-pointer">
                      <input type="radio" name="answer" value="2" class="w-5 h-5 text-blue-600 focus:ring-blue-500" />
                      <span class="text-gray-700 font-medium">Lebih dari Separuh Hari</span>
                    </label>
                    <label class="flex items-center space-x-3 cursor-pointer">
                      <input type="radio" name="answer" value="3" class="w-5 h-5 text-blue-600 focus:ring-blue-500" />
                      <span class="text-gray-700 font-medium">Hampir Setiap Hari</span>
                    </label>
                  </div>

                  <!-- Navigation Buttons -->
                  <div class="flex items-center justify-between mt-12">
                    <button
                      id="btnBack" class="px-6 py-2 text-purple-600 font-semibold hover:text-purple-700 transition"
                    >
                      &lt; Kembali
                    </button>

                    <button
                      id="btnNext"
                      class="px-8 py-3 bg-gradient-to-r from-purple-500 to-blue-500 text-white rounded-lg font-semibold hover:from-purple-600 hover:to-blue-600 transition shadow-lg"
                    >
                      Selanjutnya
                    </button>
                  </div>
                </div>
              </div>

              <!-- Right Column - Progress -->
              <div class="lg:col-span-1">
                <div
                  class="bg-white rounded-2xl shadow-sm p-6 border border-gray-200 sticky top-24"
                >
                  <h3 class="font-bold text-gray-800 mb-6">Progres Kamu</h3>

                  <!-- Progress Grid -->
                  <div class="grid grid-cols-5 gap-2">
                    <!-- Row 1 -->
                    <button
                      class="w-12 h-12 bg-blue-500 text-white rounded-lg font-semibold hover:bg-blue-600 transition"
                    >
                      1
                    </button>
                    <button
                      class="w-12 h-12 bg-white border-2 border-gray-300 text-gray-700 rounded-lg font-semibold hover:border-blue-500 transition"
                    >
                      2
                    </button>
                    <button
                      class="w-12 h-12 bg-white border-2 border-gray-300 text-gray-700 rounded-lg font-semibold hover:border-blue-500 transition"
                    >
                      3
                    </button>
                    <button
                      class="w-12 h-12 bg-white border-2 border-gray-300 text-gray-700 rounded-lg font-semibold hover:border-blue-500 transition"
                    >
                      4
                    </button>
                    <button
                      class="w-12 h-12 bg-white border-2 border-gray-300 text-gray-700 rounded-lg font-semibold hover:border-blue-500 transition"
                    >
                      5
                    </button>

                    <!-- Row 2 -->
                    <button
                      class="w-12 h-12 bg-white border-2 border-gray-300 text-gray-700 rounded-lg font-semibold hover:border-blue-500 transition"
                    >
                      6
                    </button>
                    <button
                      class="w-12 h-12 bg-white border-2 border-gray-300 text-gray-700 rounded-lg font-semibold hover:border-blue-500 transition"
                    >
                      7
                    </button>
                    <button
                      class="w-12 h-12 bg-white border-2 border-gray-300 text-gray-700 rounded-lg font-semibold hover:border-blue-500 transition"
                    >
                      8
                    </button>
                    <button
                      class="w-12 h-12 bg-white border-2 border-gray-300 text-gray-700 rounded-lg font-semibold hover:border-blue-500 transition"
                    >
                      9
                    </button>
                    <button
                      class="w-12 h-12 bg-white border-2 border-gray-300 text-gray-700 rounded-lg font-semibold hover:border-blue-500 transition"
                    >
                      10
                    </button>

                    <!-- Row 3 -->
                    <button
                      class="w-12 h-12 bg-white border-2 border-gray-300 text-gray-700 rounded-lg font-semibold hover:border-blue-500 transition"
                    >
                      11
                    </button>
                    <button
                      class="w-12 h-12 bg-white border-2 border-gray-300 text-gray-700 rounded-lg font-semibold hover:border-blue-500 transition"
                    >
                      12
                    </button>
                    <button
                      class="w-12 h-12 bg-white border-2 border-gray-300 text-gray-700 rounded-lg font-semibold hover:border-blue-500 transition"
                    >
                      13
                    </button>
                    <button
                      class="w-12 h-12 bg-white border-2 border-gray-300 text-gray-700 rounded-lg font-semibold hover:border-blue-500 transition"
                    >
                      14
                    </button>
                    <button
                      class="w-12 h-12 bg-white border-2 border-gray-300 text-gray-700 rounded-lg font-semibold hover:border-blue-500 transition"
                    >
                      15
                    </button>

                    <!-- Row 4 -->
                    <button
                      class="w-12 h-12 bg-white border-2 border-gray-300 text-gray-700 rounded-lg font-semibold hover:border-blue-500 transition"
                    >
                      16
                    </button>
                    <button
                      class="w-12 h-12 bg-white border-2 border-gray-300 text-gray-700 rounded-lg font-semibold hover:border-blue-500 transition"
                    >
                      17
                    </button>
                    <button
                      class="w-12 h-12 bg-white border-2 border-gray-300 text-gray-700 rounded-lg font-semibold hover:border-blue-500 transition"
                    >
                      18
                    </button>
                    <button
                      class="w-12 h-12 bg-white border-2 border-gray-300 text-gray-700 rounded-lg font-semibold hover:border-blue-500 transition"
                    >
                      19
                    </button>
                    <button
                      class="w-12 h-12 bg-white border-2 border-gray-300 text-gray-700 rounded-lg font-semibold hover:border-blue-500 transition"
                    >
                      20
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </main>
    </div>
  
    <script src="sadar-api.js"></script>
    <script>
      requireAuth();
      const u = getUsername();
      const el = document.getElementById("userName");
      if (el) el.textContent = u;
    </script>

    <script>
      const QUESTIONS = [
        "Kurang minat atau kesenangan dalam melakukan sesuatu.",
        "Merasa murung, sedih, atau putus asa.",
        "Sulit tidur atau terlalu banyak tidur.",
        "Merasa lelah atau kurang bertenaga.",
        "Kurang nafsu makan atau makan berlebihan.",
        "Merasa buruk tentang diri sendiri â€” merasa gagal atau mengecewakan diri/keluarga.",
        "Sulit berkonsentrasi (misalnya saat membaca atau menonton TV).",
        "Bergerak atau berbicara sangat lambat, atau sebaliknya gelisah/lebih banyak bergerak dari biasanya.",
        "Terpikir lebih baik mati atau menyakiti diri sendiri."
      ];

      // pastikan demografi sudah ada
      const demografi = JSON.parse(localStorage.getItem("sadar_demografi") || "null");
      if (!demografi) {
        window.location.href = "deteksi-depresi.html";
      }

      let idx = 0;
      const saved = JSON.parse(localStorage.getItem("sadar_answers") || "[]"); // length 0..9

      function render() {
        document.getElementById("qTitle").textContent = `Pertanyaan ${idx + 1}`;
        document.getElementById("qText").textContent = QUESTIONS[idx];

        // progress highlight (kalau tombol angka ada)
        document.querySelectorAll("button.w-12.h-12").forEach((b, i) => {
          if (i === idx) {
            b.classList.add("bg-blue-500","text-white","border-blue-500");
            b.classList.remove("bg-white","text-gray-700");
          }
        });

        // restore selected
        const val = saved[idx];
        document.querySelectorAll("input[name='answer']").forEach(r => {
          r.checked = (val !== undefined && parseInt(r.value) === val);
        });

        // back button state
        const back = document.getElementById("btnBack");
        if (back) back.style.visibility = idx === 0 ? "hidden" : "visible";
      }

      function getSelected() {
        const r = document.querySelector("input[name='answer']:checked");
        return r ? parseInt(r.value) : null;
      }

      document.getElementById("btnBack")?.addEventListener("click", (e) => {
        e.preventDefault();
        if (idx > 0) { idx--; render(); }
      });

      document.getElementById("btnNext")?.addEventListener("click", (e) => {
        e.preventDefault();
        const val = getSelected();
        if (val === null) {
          alert("Pilih salah satu jawaban dulu ya ðŸ™‚");
          return;
        }
        saved[idx] = val;
        localStorage.setItem("sadar_answers", JSON.stringify(saved));

        if (idx < 8) {
          idx++;
          render();
        } else {
          window.location.href = "deteksi-loading.html";
        }
      });

      render();
    </script>

  </body>
</html>
